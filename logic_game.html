<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kids Logic Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: 'Comic Sans MS', cursive, sans-serif;
  margin: 0; padding: 0;
  background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  overflow-x: hidden;
}
h1 { 
  margin-top: 15px;
  font-size: 40px;
  color: #e74c3c;
  text-shadow: 2px 2px #fff;
}
#question { 
  font-size: 26px; 
  margin: 10px 0; 
  color: #2c3e50;
  min-height: 50px;
  text-align:center;
}
#grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); 
  gap: 12px; 
  justify-items: center;
  width: 90%;
  max-width: 700px;
}
.answer-box { 
  width: 100px; 
  height: 100px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 50px; 
  border: 3px solid #3498db; 
  border-radius: 16px; 
  background: #fff; 
  cursor: pointer; 
  user-select: none; 
  transition: transform 0.3s, background 0.3s, border-color 0.3s;
  box-shadow: 2px 4px 12px rgba(0,0,0,0.2);
  position: relative;
}
.answer-box img { width: 90px; height: 90px; object-fit: contain; }
.answer-box.correct { animation: bounce 0.5s; border-color:#27ae60; background:#d4f7dc; }
.answer-box.wrong { animation: shake 0.5s; border-color:#e74c3c; background:#f7d4d4; }
@keyframes bounce {
  0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
  40% { transform: translateY(-20px); }
  60% { transform: translateY(-10px); }
}
@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-8px); }
  50% { transform: translateX(8px); }
  75% { transform: translateX(-8px); }
  100% { transform: translateX(0); }
}
#drop-zone { 
  margin: 10px auto; 
  width: 250px; 
  height: 100px; 
  border: 3px dashed #27ae60; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 18px; 
  border-radius: 16px; 
  color: #27ae60; 
  display: none; 
  transition: background 0.3s, border-color 0.3s;
  background: #d4f7dc;
  position: relative;
}
#drop-zone.drag-over { background: #a4e0b0; border-color: #2ecc71; color:#2c3e50; }
#message { font-size: 22px; margin-top: 8px; height: 28px; font-weight: bold; color:#2c3e50; min-height:28px;}
#score { font-size: 22px; margin-top: 5px; color: #34495e; font-weight: bold; }
#puzzle-display { display: grid; grid-template-columns: repeat(2, 100px); justify-content: center; gap: 8px; margin-bottom: 10px; font-size: 50px; }
#drag-tutorial { display:none; position:absolute; width:60px; height:60px; pointer-events:none; font-size:48px; z-index:1000; }
#hint-overlay { display:none; position:absolute; width:100px; height:100px; border: 4px solid #f1c40f; border-radius: 16px; box-shadow: 0 0 20px #f1c40f; z-index:999; pointer-events:none; }
</style>
</head>
<body>

<h1>Kids Logic Game</h1>
<div id="question">Loading...</div>
<div id="puzzle-display"></div>
<div id="grid"></div>
<div id="drop-zone">Drag & Drop Answer Here</div>
<div id="message"></div>
<div id="score">Score: 0</div>
<div id="drag-tutorial">➡️</div>
<div id="hint-overlay"></div>

<audio id="bg-music" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" loop></audio>
<audio id="success-sound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="buzz-sound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

<script>
// === Game Data ===
const items = [
  {name:"apple", src:"https://i.imgur.com/6v0zK4F.png", sound:"https://actions.google.com/sounds/v1/cartoon/pop.ogg"},
  {name:"banana", src:"https://i.imgur.com/7jZrK3l.png", sound:"https://actions.google.com/sounds/v1/cartoon/pop.ogg"},
  {name:"dog", src:"https://i.imgur.com/EnYvQ2n.png", sound:"https://actions.google.com/sounds/v1/animals/dog_bark.ogg"},
  {name:"cat", src:"https://i.imgur.com/G6xE9wH.png", sound:"https://actions.google.com/sounds/v1/animals/cat_purr.ogg"},
  {name:"flower", src:"https://i.imgur.com/5zr0X8U.png", sound:"https://actions.google.com/sounds/v1/cartoon/pop.ogg"},
  {name:"smile", src:"https://i.imgur.com/NZrFtXM.png", sound:"https://actions.google.com/sounds/v1/cartoon/pop.ogg"}
];

let score=0, correctAnswer="", currentMode="select", selectRounds=0, dragRounds=0, missingRounds=0, diffRounds=0;
const questionDisplay=document.getElementById("question");
const grid=document.getElementById("grid");
const puzzleDisplay=document.getElementById("puzzle-display");
const dropZone=document.getElementById("drop-zone");
const messageDisplay=document.getElementById("message");
const scoreDisplay=document.getElementById("score");
const dragTutorial=document.getElementById("drag-tutorial");
const hintOverlay=document.getElementById("hint-overlay");
const bgMusic=document.getElementById("bg-music");
bgMusic.volume=0.2;
bgMusic.play();

// === Helpers ===
function shuffleArray(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];} return arr;}
function speak(text){if('speechSynthesis' in window){const u=new SpeechSynthesisUtterance(text);window.speechSynthesis.speak(u);}}

// === Game Logic ===
function newRound(){
  grid.innerHTML=""; puzzleDisplay.innerHTML=""; dropZone.style.display="none"; dragTutorial.style.display="none"; messageDisplay.textContent="";
  const modes=["select","select","drag","drag","missing","missing","different","different"];
  shuffleArray(modes); currentMode=modes[0];
  
  if(currentMode==="select") generateSelect();
  else if(currentMode==="drag") generateDrag();
  else if(currentMode==="missing") generateMissing();
  else if(currentMode==="different") generateDifferent();
}

// === Select Mode ===
function generateSelect(){
  selectRounds++; dropZone.style.display="none";
  const correct=items[Math.floor(Math.random()*items.length)]; correctAnswer=correct.src;
  questionDisplay.textContent="Find the "+correct.name+"!";
  speak(questionDisplay.textContent);

  let options=[correct];
  while(options.length<4){
    const it=items[Math.floor(Math.random()*items.length)];
    if(!options.includes(it)) options.push(it);
  }
  shuffleArray(options);
  options.forEach(opt=>{
    const box=document.createElement("div"); box.className="answer-box";
    const img=document.createElement("img"); img.src=opt.src; box.appendChild(img);
    box.onclick=()=>checkAnswer(opt.src,opt.sound);
    grid.appendChild(box);
  });
}

// === Drag Mode ===
function generateDrag(){
  dragRounds++; dropZone.style.display="flex";
  const correct=items[Math.floor(Math.random()*items.length)]; correctAnswer=correct.src;
  questionDisplay.textContent="Drag the "+correct.name+" to the box!";
  speak(questionDisplay.textContent);

  let options=[correct];
  while(options.length<4){
    const it=items[Math.floor(Math.random()*items.length)];
    if(!options.includes(it)) options.push(it);
  }
  shuffleArray(options);

  options.forEach(opt=>{
    const box=document.createElement("div"); box.className="answer-box";
    const img=document.createElement("img"); img.src=opt.src; img.draggable=true; box.appendChild(img);
    img.addEventListener("dragstart",e=>e.dataTransfer.setData("text/plain",opt.src));
    grid.appendChild(box);
  });

  if(dragRounds<=2) showDragTutorial();
}

// === Drag Tutorial ===
function showDragTutorial(){
  const box=document.querySelector(".answer-box img"); if(!box) return;
  const rect=box.getBoundingClientRect(); dragTutorial.style.display="block"; dragTutorial.style.top=rect.top+"px"; dragTutorial.style.left=rect.left+"px";
  const dz=dropZone.getBoundingClientRect(); let step=0; if(window.dragTutorialInterval) clearInterval(window.dragTutorialInterval);
  window.dragTutorialInterval=setInterval(()=>{
    let t=step%40; let prog=t/20; if(prog>1) prog=2-prog;
    let x=rect.left+(dz.left-rect.left)*prog; let y=rect.top+(dz.top-rect.top)*prog;
    dragTutorial.style.left=x+"px"; dragTutorial.style.top=y+"px"; step++;
  },50);
}

// === Missing Mode ===
function generateMissing(){
  missingRounds++;
  const sequence=shuffleArray(items.slice(0)).slice(0,4);
  const missingIndex=Math.floor(Math.random()*sequence.length);
  correctAnswer=sequence[missingIndex].src;
  questionDisplay.textContent="Find the missing piece!";
  speak(questionDisplay.textContent);

  sequence.forEach((it,i)=>{ if(i!==missingIndex){const div=document.createElement("div"); div.className="answer-box"; const img=document.createElement("img"); img.src=it.src; div.appendChild(img); puzzleDisplay.appendChild(div); } });

  const options=[sequence[missingIndex]];
  while(options.length<3){ const it=items[Math.floor(Math.random()*items.length)]; if(!options.includes(it)) options.push(it); }
  shuffleArray(options);
  options.forEach(opt=>{ const box=document.createElement("div"); box.className="answer-box"; const img=document.createElement("img"); img.src=opt.src; box.appendChild(img); box.onclick=()=>checkAnswer(opt.src,opt.sound); grid.appendChild(box); });
  if(missingRounds<=2) showHint();
}

// === Find Different ===
function generateDifferent(){
  diffRounds++;
  const base=items[Math.floor(Math.random()*items.length)];
  let different=items.filter(it=>it!==base)[Math.floor(Math.random()*items.length)];
  correctAnswer=different.src;
  questionDisplay.textContent="Find the different item!";
  speak(questionDisplay.textContent);
  const options=Array(3).fill(base).concat([different]); shuffleArray(options);
  options.forEach(opt=>{ const box=document.createElement("div"); box.className="answer-box"; const img=document.createElement("img"); img.src=opt.src; box.appendChild(img); box.onclick=()=>checkAnswer(opt.src,opt.sound); grid.appendChild(box); });
}

// === Check Answer ===
function checkAnswer(selected,sound){
  const boxes=document.querySelectorAll(".answer-box");
  boxes.forEach(b=>b.classList.remove("correct","wrong"));
  if(selected===correctAnswer){
    document.getElementById("success-sound").play();
    if(sound) new Audio(sound).play();
    messageDisplay.textContent="✅ Correct!";
    speak("Correct!");
    score++; scoreDisplay.textContent="Score: "+score;
    boxes.forEach(b=>{ if(b.querySelector("img").src===selected) b.classList.add("correct"); });
    setTimeout(newRound,1200);
  } else {
    document.getElementById("buzz-sound").play();
    messageDisplay.textContent="❌ Try again!";
    speak("Try again!");
    boxes.forEach(b=>{ if(b.querySelector("img").src===selected) b.classList.add("wrong"); });
  }
}

// === Hints ===
function showHint(){ const box=document.querySelector(".answer-box img[src='"+correctAnswer+"']"); if(box){ const rect=box.getBoundingClientRect(); hintOverlay.style.top=rect.top+"px"; hintOverlay.style.left=rect.left+"px"; hintOverlay.style.display="block"; setTimeout(()=>hintOverlay.style.display="none",1500); } }

// === Drag & Drop Listeners ===
dropZone.addEventListener("dragover", e=>e.preventDefault());
dropZone.addEventListener("drop", e=>{ e.preventDefault(); const src=e.dataTransfer.getData("text/plain"); checkAnswer(src); dropZone.classList.remove("drag-over"); });
dropZone.addEventListener("dragenter", e=>dropZone.classList.add("drag-over"));
dropZone.addEventListener("dragleave", e=>dropZone.classList.remove("drag-over"));

// Start Game
newRound();
</script>
</body>
</html>

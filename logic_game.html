<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Kids Learning Game</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body {
    margin: 0;
    font-family: "Comic Sans MS", Arial, sans-serif;
    background: linear-gradient(135deg, #a8c0ff, #3f2b96);
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    color: #fff;
  }

  /* Start screen */
  #startScreen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  #startScreen h1 {
    font-size: 3.8rem;
    color: #ffeb3b;
    text-shadow: 3px 3px 8px rgba(0, 0, 0, 0.5);
    margin-bottom: 40px;
  }
  .start-button {
    font-size: 3rem;
    padding: 28px 70px;
    border-radius: 60px;
    border: none;
    background: linear-gradient(45deg, #ff4081, #ff9800, #ffeb3b);
    color: #fff;
    cursor: pointer;
    box-shadow: 0 12px 35px rgba(255, 140, 0, 0.6);
    animation: pulse 2s infinite ease-in-out;
    transition: transform 0.25s;
  }
  .start-button:hover {
    transform: scale(1.1) rotate(-1deg);
  }
  @keyframes pulse {
    0% { box-shadow: 0 0 20px #ff4081; }
    50% { box-shadow: 0 0 40px #ffeb3b; }
    100% { box-shadow: 0 0 20px #ff9800; }
  }

  /* Game container */
  .game-container {
    display: none;
    width: 100%;
    max-width: 850px;
    padding: 24px;
    box-sizing: border-box;
    text-align: center;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 24px;
    box-shadow: 0 0 35px rgba(0, 0, 0, 0.35);
  }
  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 22px;
    font-size: 1.8rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
  }
  #question {
    font-size: 2rem;
    color: #fff;
    margin: 12px auto;
  }
  .score {
    font-size: 1.6rem;
    color: #ffeb3b;
    font-weight: 700;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
  }

  /* containers */
  .option-container {
    border: 4px dashed #ffeb3b;
    border-radius: 22px;
    padding: 20px;
    margin: 25px 0;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    background: rgba(255, 255, 255, 0.15);
    justify-items: center;
    align-items: center;
  }
  .answer-container {
    border: 4px dashed #4caf50;
    border-radius: 22px;
    padding: 20px;
    margin-top: 40px;
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    background: rgba(255, 255, 255, 0.12);
  }

  /* uniform option box */
  .option {
    width: 140px;
    height: 140px;
    border-radius: 25px;
    background: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s, box-shadow 0.2s;
    cursor: pointer;
    user-select: none;
    position: relative;
    overflow: hidden;
  }
  .option img {
    width: 90%;
    height: 90%;
    object-fit: contain;
  }
  .option:hover {
    transform: scale(1.08);
  }
  .question-tile {
    cursor: default;
    pointer-events: none;
  }

  /* blank tile */
  .blank {
    background: #fafafa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: #666;
    border: 3px dashed #9e9e9e;
  }
  .shine {
    animation: shineAnim 0.9s ease-out forwards;
  }
  @keyframes shineAnim {
    0% { transform: scale(0.6); opacity: 0; }
    60% { transform: scale(1.15); opacity: 1; }
    100% { transform: scale(1); box-shadow: 0 0 25px #ffeb3b; }
  }

  /* stars */
  .star-effect {
    position: absolute;
    pointer-events: none;
    font-size: 1.8rem;
    animation: starFloat 1s ease-out forwards;
  }
  @keyframes starFloat {
    from { opacity:1; transform: translateY(0) scale(1);}
    to { opacity:0; transform: translateY(-70px) scale(2);}
  }

  /* congrats */
  .congrats {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #ffeb3b, #ff9800);
    padding: 40px 50px;
    border-radius: 25px;
    font-size: 2.2rem;
    color: #fff;
    text-align: center;
    box-shadow: 0 0 60px rgba(255,140,0,0.9);
    z-index: 2000;
    display: none;
    overflow: visible;
  }
  .congrats-star {
    position: absolute;
    font-size: 1.8rem;
    color: gold;
    animation: starFly 2.2s forwards;
  }
  @keyframes starFly {
    0% { transform: translateY(150px) scale(0.5); opacity:0;}
    50% { opacity:1; transform: translateY(-30px) scale(1.3);}
    100% { transform: translateY(-180px) scale(1.1); opacity:0;}
  }

  /* Exit button */
  #exitBtn {
    margin-top: 30px;
    padding: 16px 40px;
    border-radius: 40px;
    border: none;
    background: linear-gradient(45deg, #ff1744, #e53935);
    color: #fff;
    font-size: 1.5rem;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 8px 25px rgba(229, 57, 53, 0.6);
    transition: transform 0.25s, background 0.25s;
  }
  #exitBtn:hover {
    background: linear-gradient(45deg, #e53935, #c62828);
    transform: scale(1.05);
  }

  @media (max-width: 600px){
    .option-container { grid-template-columns: repeat(2,1fr); gap:15px; }
    .option { width:110px; height:110px;}
    .start-button { font-size:2.2rem; padding:20px 40px;}
  }
</style>
</head>
<body>

<div id="startScreen">
  <h1>üåü Fun Learning Game üåü</h1>
  <button id="startBtn" class="start-button">‚ñ∂ Start Game</button>
</div>

<div id="game" class="game-container" aria-live="polite">
  <div class="top-bar">
    <div id="question"></div>
    <div id="score" class="score">Score: 0</div>
  </div>
  <div id="options"></div>
  <button id="exitBtn">‚èπ Exit Game</button>
</div>

<div id="congrats" class="congrats"></div>

<audio id="bgMusic" src="https://actions.google.com/sounds/v1/musical/melodious_tunes.ogg" loop></audio>
<audio id="correctSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="wrongSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="congratsMusic" src="https://actions.google.com/sounds/v1/cartoon/party_horn.ogg"></audio>

<script>
/* ---------- DATA ---------- */
const imageList = ["apple","ball","banana","car","cat","cherry","dog","fish","flower","orange"];
let currentMode = "find";
let voicesReady = false;
let score = 0;
let waitingNextRound = false;
let roundAnswered = false;
const loadedImages = {};
const bgMusic = document.getElementById('bgMusic');
const correctSound = document.getElementById('correctSound');
const wrongSound = document.getElementById('wrongSound');
const congratsMusic = document.getElementById('congratsMusic');
const scoreEl = document.getElementById('score');
const congratsEl = document.getElementById('congrats');
const startBtn = document.getElementById('startBtn');
const startScreen = document.getElementById('startScreen');
const game = document.getElementById('game');
const qEl = document.getElementById('question');
const optionsEl = document.getElementById('options');
const exitBtn = document.getElementById('exitBtn');

/* preload images */
imageList.forEach(name => { const img = new Image(); img.src = `image/${name}.png`; loadedImages[name]=img; });

/* start / exit */
startBtn.addEventListener('click', ()=>{
  voicesReady=true;
  try{ bgMusic.play(); }catch(e){}
  startScreen.style.display='none';
  game.style.display='block';
  score=0; updateScore();
  nextRound();
});
exitBtn.addEventListener('click', ()=>{ window.location.href='index.html'; });

/* speech helper */
function speak(text, cb=null){
  if(!voicesReady){ if(cb) setTimeout(cb,400); return; }
  const u = new SpeechSynthesisUtterance(text);
  u.rate = 0.8; u.pitch = 1.15;
  if(cb) u.onend = cb;
  speechSynthesis.speak(u);
}

/* score */
function updateScore(){ scoreEl.textContent=`Score: ${score}`; }

/* utils */
function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5); }

function nextRound(){
  if(waitingNextRound) return;
  roundAnswered=false; optionsEl.innerHTML='';
  const modes=['find','different','missing','memory','shadow'];
  currentMode = modes[Math.floor(Math.random()*modes.length)];
  if(currentMode==='find') startFindRound();
  else if(currentMode==='different') startDifferentRound();
  else if(currentMode==='missing') startMissingRound();
  else if(currentMode==='memory') startMemoryRound();
  else startShadowRound();
}

function createQuestionTile(name,parent){
  const tile=document.createElement('div'); tile.className='option question-tile';
  const img=document.createElement('img'); img.src=loadedImages[name].src; img.alt=name;
  tile.appendChild(img); parent.appendChild(tile);
}

function createAnswerTile(name,isCorrect,parent,blankDiv=null,missing=null){
  const tile=document.createElement('div'); tile.className='option'; tile.dataset.correct=isCorrect?'1':'0';
  const img=document.createElement('img'); img.src=loadedImages[name].src; img.alt=name; tile.appendChild(img);
  tile.addEventListener('click',()=>{
    if(roundAnswered) return;
    const correct = tile.dataset.correct==='1';
    if(correct){
      roundAnswered=true; score++; updateScore();
      try{ correctSound.currentTime=0; correctSound.play(); }catch(e){}
      if(blankDiv && missing){ blankDiv.innerHTML=''; const im=document.createElement('img'); im.src=loadedImages[missing].src; im.alt=missing; im.className='shine'; blankDiv.appendChild(im); addStars(blankDiv); }
      else addStars(tile);
      speak('Well done!',()=>setTimeout(()=>nextRound(),500));
    }else{ try{ wrongSound.currentTime=0; wrongSound.play(); }catch(e){}; speak('Try again'); }
  });
  parent.appendChild(tile);
}

function addStars(target){
  const rect=target.getBoundingClientRect();
  for(let i=0;i<6;i++){
    const s=document.createElement('div'); s.className='star-effect'; s.textContent='‚≠ê';
    const x=rect.left+rect.width/2+(Math.random()*60-30); const y=rect.top+rect.height/2+(Math.random()*20-10);
    s.style.left=x+'px'; s.style.top=y+'px';
    document.body.appendChild(s); setTimeout(()=>s.remove(),1100);
  }
}

/* ---------- GAMES ---------- */
function startFindRound(){
  const choices=shuffle(imageList).slice(0,4);
  const target=choices[Math.floor(Math.random()*choices.length)];
  qEl.textContent=`Find the ${target}`; speak(`Can you find the ${target}?`);
  const ansContainer=document.createElement('div'); ansContainer.className='answer-container';
  shuffle(choices).forEach(name=>createAnswerTile(name,name===target,ansContainer));
  optionsEl.appendChild(ansContainer);
}

function startDifferentRound(){
  const base=imageList[Math.floor(Math.random()*imageList.length)];
  let odd; do{ odd=imageList[Math.floor(Math.random()*imageList.length)]; } while(odd===base);
  qEl.textContent='Find the different one!'; speak('Which one is different?');
  const arr=shuffle([base,base,base,odd]);
  const ansContainer=document.createElement('div'); ansContainer.className='answer-container';
  arr.forEach(name=>createAnswerTile(name,name===odd,ansContainer));
  optionsEl.appendChild(ansContainer);
}

function startMissingRound(){
  const selected=shuffle(imageList).slice(0,6);
  const missingIndex=Math.floor(Math.random()*selected.length);
  const missing=selected[missingIndex]; const itemsInGrid=selected.filter((_,idx)=>idx!==missingIndex);
  qEl.textContent='Which picture is missing?'; speak('Which picture is missing?');
  const questionContainer=document.createElement('div'); questionContainer.className='option-container';
  let blankDiv=null;
  selected.forEach((name,idx)=>{ if(idx===missingIndex){ blankDiv=document.createElement('div'); blankDiv.className='option blank'; questionContainer.appendChild(blankDiv);} else createQuestionTile(name,questionContainer); });
  optionsEl.appendChild(questionContainer);
  const wrongOptions=shuffle(itemsInGrid).slice(0,2); const answerChoices=shuffle([missing,...wrongOptions]);
  const answerContainer=document.createElement('div'); answerContainer.className='answer-container';
  answerChoices.forEach(name=>createAnswerTile(name,name===missing,answerContainer,blankDiv,missing));
  optionsEl.appendChild(answerContainer);
}

function startMemoryRound(){
  const selected=shuffle(imageList).slice(0,2); const pair=shuffle([...selected,...selected]);
  qEl.textContent='Can you match the pair?'; speak('Can you find the matching pair?');
  const container=document.createElement('div'); container.className='option-container';
  pair.forEach(name=>createAnswerTile(name,true,container));
  optionsEl.appendChild(container);
}

function startShadowRound(){
  const target=imageList[Math.floor(Math.random()*imageList.length)];
  qEl.textContent=`Find the shadow of ${target}`; speak(`Can you find the shadow of ${target}?`);
  const shadows=shuffle([target,...shuffle(imageList.filter(i=>i!==target)).slice(0,2)]);
  const container=document.createElement('div'); container.className='answer-container';
  shadows.forEach(name=>createAnswerTile(name,name===target,container));
  optionsEl.appendChild(container);
}
</script>

</body>
</html>

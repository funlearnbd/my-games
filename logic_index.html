<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kids Logic Game</title>
<style>
body {
  font-family: 'Comic Sans MS', cursive, sans-serif;
  margin:0;
  padding:0;
  background: linear-gradient(135deg, #ffe6f0 0%, #b3e5fc 50%, #c8e6c9 100%);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
}
.container {
  background: rgba(255,245,157,0.9);
  border-radius:25px;
  padding:15px;
  width:100%;
  max-width:500px;
  min-height:100vh;
  text-align:center;
  box-shadow:0 8px 20px rgba(0,0,0,0.15);
  box-sizing:border-box;
  position:relative;
}
h1 {margin:10px 0;color:#d81b60;font-size:2rem;}
.top-bar {display:flex;justify-content:space-between;align-items:center;padding:0 10px;}
.level-display {color:#0288d1;font-size:1.2rem;font-weight:bold;}
.instructions {font-size:1.4rem;color:#d81b60;margin:10px 0;}
.emoji-grid, .options-grid {
  display:grid;
  gap:10px;
  margin:15px 10px;
}
.emoji-grid {grid-template-columns: repeat(auto-fit, minmax(90px,1fr));}
.options-grid {grid-template-columns: repeat(3, 1fr);}
.emoji-item {
  border:2px solid #333;
  border-radius:15px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:3rem;
  aspect-ratio:1/1;
  position:relative;
  overflow:hidden;
  background:#fff3e0;
}
.emoji-item.correct {animation: sparkle 1s ease-out;}
.emoji-item.incorrect {animation: shake 0.5s ease-out;}
@keyframes sparkle {
  0% {transform:scale(1); box-shadow:0 0 0 0 #ffd700;}
  50% {transform:scale(1.3); box-shadow:0 0 15px 8px rgba(255,215,0,0.7);}
  100% {transform:scale(1); box-shadow:0 0 0 0 transparent;}
}
@keyframes shake {0%,100%{transform:translateX(0);}25%{transform:translateX(-8px);}75%{transform:translateX(8px);}}
.star-effect {
  position:absolute;
  width:100%;
  height:100%;
  pointer-events:none;
  top:0; left:0;
  background:url('https://i.ibb.co/2d2K9p7/star.png') center center no-repeat;
  background-size:contain;
  animation: starfade 1s ease-out forwards;
}
@keyframes starfade {0%{opacity:1;}100%{opacity:0; transform:scale(1.5);}}
.start-btn {
  background: linear-gradient(45deg,#ff4081,#ff80ab);
  color:white;
  font-weight:bold;
  padding:20px;
  border-radius:25px;
  border:none;
  cursor:pointer;
  font-size:2rem;
  animation: shine 1.5s infinite alternate;
}
@keyframes shine {0%{box-shadow:0 0 10px #fff;}100%{box-shadow:0 0 25px #ffd700;}}
.loading-screen {
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:rgba(0,0,0,0.5); color:white; display:flex; justify-content:center; align-items:center; font-size:2rem; z-index:1000;
}
</style>
</head>
<body>
<div class="container" id="game-container">
  <h1>Fun Logic Adventure ðŸŒŸ</h1>
  <button class="start-btn" id="start-btn">Start Game</button>
</div>

<audio id="bg-music" loop preload="auto">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_2a9b9d347d.mp3" type="audio/mpeg">
</audio>

<script>
const gameContainer = document.getElementById('game-container');
const startBtn = document.getElementById('start-btn');
const bgMusic = document.getElementById('bg-music');
let level = 1, score = 0;
const maxLevels = 100;
const imageList = ['apple','ball','banana','car','cat','cherry','dog','fish','flower','orange'];
const images = {};
const feedback = ['Super job! ðŸŒŸ','Wow, awesome!','Youâ€™re a star!','Fantastic!','Yay, you did it!'];
const levelTypes = [
  {type:'findTarget', prompt:'Find the'},
  {type:'findMissing', prompt:'Find the missing item!'},
  {type:'findDifferent', prompt:'Find the different item!'}
];
let tutorialShown = 0;

function speak(text, callback){
  const synth = window.speechSynthesis;
  const utter = new SpeechSynthesisUtterance(text);
  utter.rate = 0.8 + level*0.003; 
  utter.pitch = 1.2;
  utter.onend = ()=>{ if(callback) callback(); };
  synth.speak(utter);
}

function preloadImages(callback){
  const loadingOverlay = document.createElement('div');
  loadingOverlay.className = 'loading-screen';
  const loadingText = document.createElement('div');
  loadingText.className = 'loading-text';
  loadingText.innerText = 'Loading 0%';
  loadingOverlay.appendChild(loadingText);
  document.body.appendChild(loadingOverlay);

  let loaded = 0;
  const firstLoad = !sessionStorage.getItem('gameFirstLoad');

  imageList.forEach(name=>{
    const img = new Image();
    img.src = firstLoad ? `image/${name}.png?v=${Date.now()}` : `image/${name}.png`;
    img.onload = img.onerror = ()=>{
      images[name] = img.src;
      loaded++;
      loadingText.innerText = `Loading ${Math.floor(loaded/imageList.length*100)}%`;
      if(loaded===imageList.length){
        sessionStorage.setItem('gameFirstLoad','true');
        setTimeout(()=>{
          loadingOverlay.remove();
          callback();
        }, 300);
      }
    };
  });
}

function startGame(){
  bgMusic.volume=0.15;
  bgMusic.play().catch(()=>{});
  level = 1;
  score = 0;
  nextRound();
}

function getRandomItem(arr){return arr[Math.floor(Math.random()*arr.length)];}

function nextRound(){
  gameContainer.innerHTML = `<h1>Fun Logic Adventure ðŸŒŸ</h1>`;
  const currentLevelType = levelTypes[(level-1)%levelTypes.length];
  let chosen = [...imageList].sort(()=>0.5-Math.random()).slice(0,4); 
  let instructionText = '';
  let correctAnswer = '';

  if(currentLevelType.type==='findTarget'){
    correctAnswer = getRandomItem(chosen);
    instructionText = `${currentLevelType.prompt} ${correctAnswer}`;
    const p = document.createElement('p'); p.className='instructions'; p.innerText=instructionText;
    gameContainer.appendChild(p);
    speak(instructionText,()=>{});
    const grid = document.createElement('div'); grid.className='emoji-grid';
    chosen.forEach(name=>{
      const div = document.createElement('div'); div.className='emoji-item';
      const img = document.createElement('img'); img.src=images[name]; img.style.width='80%'; img.style.height='80%';
      div.appendChild(img);
      div.onclick=()=>checkAnswer(div,name,correctAnswer);
      grid.appendChild(div);
    });
    gameContainer.appendChild(grid);
  } else if(currentLevelType.type==='findMissing'){
    chosen = [...imageList].sort(()=>0.5-Math.random()).slice(0,5);
    correctAnswer = getRandomItem(chosen);
    const missingIndex = Math.floor(Math.random()*chosen.length);
    const display = chosen.map((name,i)=>(i===missingIndex?'':name));
    instructionText = currentLevelType.prompt;
    const p = document.createElement('p'); p.className='instructions'; p.innerText=instructionText;
    gameContainer.appendChild(p);
    speak(instructionText,()=>{});
    const grid = document.createElement('div'); grid.className='emoji-grid';
    display.forEach((name,i)=>{
      const div = document.createElement('div'); div.className='emoji-item';
      if(name){const img=document.createElement('img'); img.src=images[name]; img.style.width='80%'; img.style.height='80%'; div.appendChild(img);}
      grid.appendChild(div);
    });
    gameContainer.appendChild(grid);
    // options
    const options = [correctAnswer,...[...imageList].filter(i=>i!==correctAnswer).sort(()=>0.5-Math.random()).slice(0,2)];
    options.sort(()=>0.5-Math.random());
    const optionsGrid=document.createElement('div'); optionsGrid.className='options-grid';
    options.forEach(name=>{
      const div=document.createElement('div'); div.className='emoji-item';
      const img=document.createElement('img'); img.src=images[name]; img.style.width='80%'; img.style.height='80%';
      div.appendChild(img);
      div.onclick=()=>{
        const gridDivs=grid.children;
        gridDivs[missingIndex].innerHTML=''; 
        const imgNew=document.createElement('img'); imgNew.src=images[name]; imgNew.style.width='80%'; imgNew.style.height='80%';
        gridDivs[missingIndex].appendChild(imgNew);
        checkAnswer(div,name,correctAnswer);
      };
      optionsGrid.appendChild(div);
    });
    gameContainer.appendChild(optionsGrid);
  } else if(currentLevelType.type==='findDifferent'){
    chosen = [...imageList].sort(()=>0.5-Math.random()).slice(0,4);
    correctAnswer = getRandomItem([...imageList].filter(i=>!chosen.includes(i)));
    const replaceIndex=Math.floor(Math.random()*chosen.length);
    chosen[replaceIndex]=correctAnswer;
    instructionText=currentLevelType.prompt;
    const p=document.createElement('p'); p.className='instructions'; p.innerText=instructionText;
    gameContainer.appendChild(p);
    speak(instructionText,()=>{});
    const grid=document.createElement('div'); grid.className='emoji-grid';
    chosen.forEach(name=>{
      const div=document.createElement('div'); div.className='emoji-item';
      const img=document.createElement('img'); img.src=images[name]; img.style.width='80%'; img.style.height='80%';
      div.appendChild(img);
      div.onclick=()=>checkAnswer(div,name,correctAnswer);
      grid.appendChild(div);
    });
    gameContainer.appendChild(grid);
  }
}

function checkAnswer(div,name,correct){
  if(name===correct){
    div.classList.add('correct');
    score+=10;
    const star=document.createElement('div'); star.className='star-effect';
    div.appendChild(star);
    speak(getRandomItem(feedback),()=>{setTimeout(()=>{level++; nextRound();},500);});
  } else {
    div.classList.add('incorrect');
    speak('Oops, try again!');
    setTimeout(()=>div.classList.remove('incorrect'),800);
  }
}

startBtn.onclick = ()=>{
  preloadImages(startGame);
};
</script>
</body>
</html>

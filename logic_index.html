<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Kids Learning Game</title>
  <style>
    body {
      margin: 0;
      font-family: Comic Sans MS, Arial, sans-serif;
      background: linear-gradient(135deg, #ffecd2, #fcb69f);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }

    /* --- Start screen --- */
    #startScreen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    #startScreen h1 {
      font-size: 3em;
      color: #ff4081;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.3);
      margin-bottom: 40px;
    }

    .start-button {
      font-size: 3em;
      padding: 25px 60px;
      border: none;
      border-radius: 60px;
      background: linear-gradient(45deg, gold, orange);
      color: white;
      cursor: pointer;
      animation: glow 1.5s infinite alternate;
      box-shadow: 0 0 30px gold;
    }
    @keyframes glow {
      from { box-shadow: 0 0 30px gold; }
      to   { box-shadow: 0 0 50px orange; }
    }

    /* --- Game screen --- */
    .game-container {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
    }

    .question {
      font-size: 2.2em;
      margin-bottom: 25px;
      color: #333;
    }

    .options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 20px;
      max-width: 90%;
    }

    .option {
      width: 160px;
      height: 160px;
      border-radius: 25px;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.2s;
      box-shadow: 0 6px 12px rgba(0,0,0,0.25);
    }

    .option img {
      max-width: 95%;
      max-height: 95%;
    }

    .option:hover {
      transform: scale(1.1);
    }

    .star-effect {
      position: absolute;
      pointer-events: none;
      font-size: 2em;
      animation: starFloat 1s ease-out forwards;
    }
    @keyframes starFloat {
      from { opacity: 1; transform: translateY(0) scale(1); }
      to   { opacity: 0; transform: translateY(-50px) scale(2); }
    }
  </style>
</head>
<body>

  <div id="startScreen">
    <h1>🌟 Fun Learning Game 🌟</h1>
    <button id="startBtn" class="start-button">▶ Start Game</button>
  </div>

  <div id="game" class="game-container">
    <div id="question" class="question"></div>
    <div id="options" class="options"></div>
  </div>

  <script>
    const imageList = [
      "apple","ball","banana","car","cat",
      "cherry","dog","fish","flower","orange"
    ];

    let currentMode = "find"; 
    let lastAnswer = null;
    let voicesReady = false;

    function speak(text) {
      if (!voicesReady) return;
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = 1;
      utter.pitch = 1.2;
      speechSynthesis.speak(utter);
    }

    // Preload images
    const loadedImages = {};
    imageList.forEach(name => {
      const img = new Image();
      img.src = `image/${name}.png`;
      loadedImages[name] = img;
    });

    const startBtn = document.getElementById("startBtn");
    const startScreen = document.getElementById("startScreen");
    const game = document.getElementById("game");
    const qEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");

    startBtn.addEventListener("click", () => {
      voicesReady = true;
      if (speechSynthesis.getVoices().length === 0) {
        speechSynthesis.onvoiceschanged = () => voicesReady = true;
      }
      startScreen.style.display = "none";
      game.style.display = "flex";
      nextRound();
    });

    function nextRound() {
      optionsEl.innerHTML = "";
      const modes = ["find","different","missing"];
      currentMode = modes[Math.floor(Math.random() * modes.length)];

      if (currentMode === "find") startFindRound();
      else if (currentMode === "different") startDifferentRound();
      else if (currentMode === "missing") startMissingRound();
    }

    function startFindRound() {
      const choices = shuffle([...imageList]).slice(0,4);
      const target = choices[Math.floor(Math.random()*choices.length)];
      lastAnswer = target;

      qEl.textContent = `Find the ${target}`;
      speak(`Can you find the ${target}?`);

      choices.forEach(name => createOption(name, name === target));
    }

    function startDifferentRound() {
      const base = imageList[Math.floor(Math.random()*imageList.length)];
      let odd;
      do { odd = imageList[Math.floor(Math.random()*imageList.length)]; }
      while (odd === base);

      const options = [base, base, base, odd];
      qEl.textContent = "Find the different one!";
      speak("Which one is different?");

      shuffle(options).forEach(name => createOption(name, name === odd));
    }

    function startMissingRound() {
      const selected = shuffle([...imageList]).slice(0,5);
      const missing = selected[Math.floor(Math.random()*selected.length)];
      const shown = selected.filter(n => n !== missing);

      qEl.textContent = "Which one is missing?";
      speak("Which picture is missing?");

      // First set (with blank)
      shown.forEach(name => createOption(name, false));
      const blankDiv = document.createElement("div");
      blankDiv.className = "option";
      blankDiv.style.background = "#eee";
      blankDiv.textContent = "?";
      blankDiv.style.fontSize = "3em";
      optionsEl.appendChild(blankDiv);

      // Second set (choices)
      const secondSet = shuffle([missing, ...shuffle(shown).slice(0,2)]);
      secondSet.forEach(name => createOption(name, name === missing));
    }

    function createOption(name, isCorrect) {
      const div = document.createElement("div");
      div.className = "option";
      const img = document.createElement("img");
      img.src = loadedImages[name].src;
      div.appendChild(img);
      div.onclick = () => {
        if (isCorrect) {
          addStars(div);
          speak("Great job!");
          setTimeout(nextRound, 1500);
        } else {
          speak("Try again");
        }
      };
      optionsEl.appendChild(div);
    }

    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }

    function addStars(target) {
      for (let i=0;i<5;i++) {
        const star = document.createElement("div");
        star.className = "star-effect";
        star.textContent = "⭐";
        const rect = target.getBoundingClientRect();
        star.style.left = rect.left + rect.width/2 + "px";
        star.style.top = rect.top + rect.height/2 + "px";
        document.body.appendChild(star);
        setTimeout(()=>star.remove(),1000);
      }
    }
  </script>
</body>
</html>

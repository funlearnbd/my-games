<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logic Game</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #eef2f8;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .game-container {
            background: #fff;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 900px;
            width: 95%;
            text-align: center;
            transition: all 0.3s ease;
        }
        h1 {
            margin-top: 0;
            color: #2c3e50;
        }
        #question {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 15px 0;
            color: #34495e;
            min-height: 2rem;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        #puzzle-grid {
            margin-bottom: 0;
        }
        #choices-grid {
            margin-top: 10px;
        }
        .item {
            background: #f8f9fa;
            border: 2px solid #ced4da;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            font-size: 3rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
        }
        .item:hover:not(.disabled) {
            transform: scale(1.05);
            border-color: #2980b9;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .item.correct {
            border-color: #27ae60;
            background-color: #e8f9f5;
            animation: bounce 0.5s;
        }
        .item.incorrect {
            border-color: #c0392b;
            background-color: #ffe8e8;
            animation: shake 0.5s;
        }
        .item.disabled {
            cursor: default;
            opacity: 0.7;
        }
        #message {
            font-size: 1.3rem;
            font-weight: bold;
            margin-top: 10px;
            min-height: 30px;
        }
        #score {
            margin-top: 10px;
            font-size: 1.1rem;
            color: #2d3436;
        }
        .btns {
            margin-top: 20px;
        }
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 30px;
            margin: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            color: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s ease, background 0.2s ease;
        }
        button:hover {
            transform: translateY(-2px);
        }
        #newGameBtn { background: #27ae60; }
        #exitBtn { background: #e74c3c; }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Logic Game</h1>
        <div id="question"></div>
        <div id="puzzle-grid" class="grid"></div>
        <div id="choices-grid" class="grid"></div>
        <div id="message"></div>
        <div id="score">Score: 0</div>
        <div class="btns">
            <button id="newGameBtn">New Game</button>
            <button id="exitBtn">Exit Game</button>
        </div>
    </div>

    <script>
        const items = [
            { name: "Apple", emoji: "🍎" },
            { name: "Banana", emoji: "🍌" },
            { name: "Car", emoji: "🚗" },
            { name: "Dog", emoji: "🐶" },
            { name: "Cat", emoji: "🐱" },
            { name: "Flower", emoji: "🌸" },
            { name: "Ball", emoji: "⚽" },
            { name: "Star", emoji: "⭐" },
            { name: "Tree", emoji: "🌳" },
            { name: "Fish", emoji: "🐟" },
            { name: "Happy Face", emoji: "😊" },
            { name: "Sad Face", emoji: "😢" },
            { name: "Sun", emoji: "☀️" },
            { name: "Moon", emoji: "🌙" },
            { name: "Heart", emoji: "❤️" }
        ];

        let score = 0;
        let correctAnswer = null;
        let gameActive = true;

        const puzzleGrid = document.getElementById("puzzle-grid");
        const choicesGrid = document.getElementById("choices-grid");
        const questionEl = document.getElementById("question");
        const messageEl = document.getElementById("message");
        const scoreEl = document.getElementById("score");
        const newGameBtn = document.getElementById("newGameBtn");
        const exitBtn = document.getElementById("exitBtn");

        function shuffle(arr) {
            return arr.sort(() => Math.random() - 0.5);
        }

        function newRound() {
            gameActive = true;
            messageEl.textContent = "";
            puzzleGrid.innerHTML = "";
            choicesGrid.innerHTML = "";
            const gameModes = ["find", "different", "missing"];
            const mode = gameModes[Math.floor(Math.random() * gameModes.length)];

            if (mode === "find") {
                setupFind();
                puzzleGrid.style.display = 'grid';
                choicesGrid.style.display = 'none';
            }
            else if (mode === "different") {
                setupDifferent();
                puzzleGrid.style.display = 'grid';
                choicesGrid.style.display = 'none';
            }
            else if (mode === "missing") {
                setupMissing();
                puzzleGrid.style.display = 'grid';
                choicesGrid.style.display = 'grid';
            }
        }

        function setupFind() {
            const chosen = items[Math.floor(Math.random() * items.length)];
            correctAnswer = chosen.name;
            questionEl.textContent = `Find the ${chosen.name}!`;
            const options = shuffle([chosen, ...shuffle(items).filter(item => item.name !== chosen.name).slice(0, 5)]);

            options.forEach(opt => {
                const div = document.createElement("div");
                div.className = "item";
                div.textContent = opt.emoji;
                div.onclick = () => checkAnswer(opt.name, div);
                puzzleGrid.appendChild(div);
            });
        }

        function setupDifferent() {
            const common = items[Math.floor(Math.random() * items.length)];
            let diff;
            do {
                diff = items[Math.floor(Math.random() * items.length)];
            } while (diff.name === common.name);
            correctAnswer = diff.name;
            questionEl.textContent = "Find the different item!";

            let options = Array(5).fill(common).concat(diff);
            options = shuffle(options);
            
            options.forEach(opt => {
                const div = document.createElement("div");
                div.className = "item";
                div.textContent = opt.emoji;
                div.onclick = () => checkAnswer(opt.name, div);
                puzzleGrid.appendChild(div);
            });
        }

        function setupMissing() {
            // Select 3 unique items for the puzzle pattern and the answer
            let selectedItems = shuffle(items).slice(0, 3);
            const puzzleItemA = selectedItems[0];
            const puzzleItemB = selectedItems[1];
            const correctItem = selectedItems[2];

            correctAnswer = correctItem.name;
            questionEl.textContent = "Find the missing piece!";

            // Display the puzzle pattern and blank box
            puzzleGrid.innerHTML = '';
            const puzzleSequence = [puzzleItemA, puzzleItemB, puzzleItemA, puzzleItemB];
            
            puzzleSequence.forEach(opt => {
                const div = document.createElement("div");
                div.className = "item disabled";
                div.textContent = opt.emoji;
                puzzleGrid.appendChild(div);
            });
            const placeholder = document.createElement("div");
            placeholder.className = "item disabled";
            placeholder.textContent = "?";
            puzzleGrid.appendChild(placeholder);

            // Create answer choices: the correct one and three incorrect ones
            // Ensure incorrect choices are unique from the puzzle items and correct answer
            let incorrectChoices = shuffle(items.filter(i => 
                i.name !== puzzleItemA.name && i.name !== puzzleItemB.name && i.name !== correctItem.name
            )).slice(0, 1);
            
            // Combine the correct item and incorrect choices for the answers grid
            const answers = shuffle([correctItem, puzzleItemA, puzzleItemB, ...incorrectChoices]);
            choicesGrid.innerHTML = '';

            // Render the answer choices
            answers.forEach(opt => {
                const div = document.createElement("div");
                div.className = "item";
                div.textContent = opt.emoji;
                div.onclick = () => {
                    if (gameActive) {
                        if (opt.name === correctAnswer) {
                            placeholder.textContent = opt.emoji;
                            placeholder.classList.add('correct');
                        }
                        checkAnswer(opt.name, div);
                    }
                };
                choicesGrid.appendChild(div);
            });
        }

        function checkAnswer(ans, element) {
            if (!gameActive) return;

            if (ans === correctAnswer) {
                gameActive = false;
                messageEl.textContent = "✅ Correct!";
                messageEl.style.color = "#27ae60";
                score++;
                scoreEl.textContent = "Score: " + score;
                element.classList.add("correct");
                setTimeout(newRound, 1500);
            } else {
                messageEl.textContent = "❌ Try again!";
                messageEl.style.color = "#e74c3c";
                element.classList.add("incorrect");
                setTimeout(() => {
                    element.classList.remove("incorrect");
                    messageEl.textContent = "";
                    messageEl.style.color = "";
                }, 800);
            }
        }

        newGameBtn.onclick = () => {
            score = 0;
            scoreEl.textContent = "Score: 0";
            newRound();
        };

        exitBtn.onclick = () => {
            window.location.href = "index.html";
        };

        window.onload = newRound;
    </script>
</body>
</html>

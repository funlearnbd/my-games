<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kids Game</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
    background: #f0f8ff;
  }
  h1 {
    font-size: 24px;
    margin: 10px 0;
  }
  #game {
    margin: 10px auto;
    max-width: 800px;
  }
  .option-container, .answer-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin: 10px 0;
  }
  .option {
    border: 2px solid #333;
    border-radius: 10px;
    background: #fff;
    padding: 5px;
    cursor: pointer;
    transition: transform 0.2s;
  }
  .option:hover {
    transform: scale(1.05);
  }
  .option img {
    max-width: 120px;
    max-height: 120px;
  }
  .blank {
    background: #ddd;
    width: 120px;
    height: 120px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #congrats {
    display: none;
    font-size: 24px;
    margin: 20px;
    color: #e91e63;
    font-weight: bold;
  }
  #score {
    font-size: 20px;
    margin: 10px;
  }
  .congrats-star {
    position: fixed;
    font-size: 24px;
    color: gold;
    animation: fly 2s linear;
  }
  @keyframes fly {
    from { transform: translateY(0); opacity: 1; }
    to { transform: translateY(-300px); opacity: 0; }
  }
  #exitBtn {
    margin-top: 15px;
    padding: 8px 16px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    background: #ff5252;
    color: white;
    cursor: pointer;
  }

  /* 📱 Responsive fix for phones */
  @media (max-width: 600px) {
    .option img {
      max-width: 80px;
      max-height: 80px;
    }
    .blank {
      width: 80px;
      height: 80px;
    }
    h1 {
      font-size: 18px;
    }
    #score {
      font-size: 16px;
    }
  }
</style>
</head>
<body>
  <h1 id="question">Press Start to Play!</h1>
  <div id="score">Score: 0</div>
  <button onclick="startGame()">Start Game</button>
  <div id="game">
    <div id="options"></div>
  </div>
  <div id="congrats"></div>
  <button id="exitBtn" onclick="window.location.href='index.html'">Exit</button>

<script>
const imageList = ["🐶","🐱","🐰","🐸","🐵","🦁","🐮","🐷","🐔","🐟"];
const optionsEl = document.getElementById('options');
const qEl = document.getElementById('question');
const scoreEl = document.getElementById('score');
const congratsEl = document.getElementById('congrats');

let score = 0;
let roundNumber = 0;
let currentDifficulty = 'beginner';
let roundAnswered = false;

function shuffle(arr){ return arr.sort(()=>Math.random()-0.5); }

function speak(text, cb){
  const u = new SpeechSynthesisUtterance(text);
  u.rate = 0.9;
  u.onend = cb;
  speechSynthesis.speak(u);
}

function startGame(){
  score = 0;
  roundNumber = 0;
  currentDifficulty = 'beginner';
  scoreEl.textContent = 'Score: 0';
  nextRound();
}

function updateScore(){ scoreEl.textContent = 'Score: '+score; }

function nextRound(){
  roundAnswered = false;
  optionsEl.innerHTML = '';
  roundNumber++;

  // Difficulty upgrade
  let newDiff = currentDifficulty;
  if(roundNumber >= 11) newDiff = 'advanced';
  else if(roundNumber >= 6) newDiff = 'intermediate';

  if(newDiff !== currentDifficulty){
    showLevelUp(newDiff, ()=>{ currentDifficulty = newDiff; nextRound(); });
    return;
  }

  const modes = ['find','different','missing'];
  const mode = modes[Math.floor(Math.random()*modes.length)];
  if(mode==='find') startFindRound();
  else if(mode==='different') startDifferentRound();
  else startMissingRound();
}

function showLevelUp(level, cb){
  congratsEl.innerHTML = `🎉 Level Up! 🎉<br>You reached ${level}!`;
  congratsEl.style.display = 'block';
  for(let i=0;i<15;i++){
    const s=document.createElement('div');
    s.className='congrats-star'; s.textContent='⭐';
    s.style.left = (Math.random()*window.innerWidth)+'px';
    s.style.top = (window.innerHeight-20)+'px';
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),2000);
  }
  speak(`Congratulations! You reached ${level}`, ()=>{
    congratsEl.style.display='none';
    if(cb) cb();
  });
}

function createAnswerTile(symbol,isCorrect){
  const tile=document.createElement('div');
  tile.className='option';
  tile.innerHTML=`<div style="font-size:50px">${symbol}</div>`;
  tile.onclick=()=>{
    if(roundAnswered) return;
    if(isCorrect){
      roundAnswered=true;
      score++; updateScore();
      speak('Well done!', ()=> setTimeout(()=>nextRound(),500));
    } else {
      speak('Try again');
    }
  };
  return tile;
}

// --- Game Rounds ---
function startFindRound(){
  let numChoices = currentDifficulty==='beginner'?3:4;
  const choices=shuffle(imageList).slice(0,numChoices);
  const target=choices[Math.floor(Math.random()*choices.length)];
  qEl.textContent=`Find the ${target}`;
  speak(`Can you find the ${target}?`);
  const ans=document.createElement('div'); ans.className='answer-container';
  shuffle(choices).forEach(c=> ans.appendChild(createAnswerTile(c,c===target)));
  optionsEl.appendChild(ans);
}

function startDifferentRound(){
  let base=imageList[Math.floor(Math.random()*imageList.length)];
  let odd; do{ odd=imageList[Math.floor(Math.random()*imageList.length)]; }while(odd===base);
  let arr;
  if(currentDifficulty==='beginner') arr=[base,odd,base]; 
  else arr=shuffle([base,base,base,odd]);
  qEl.textContent='Find the different one!';
  speak('Which one is different?');
  const ans=document.createElement('div'); ans.className='answer-container';
  arr.forEach(c=> ans.appendChild(createAnswerTile(c,c===odd)));
  optionsEl.appendChild(ans);
}

function startMissingRound(){
  let numItems = currentDifficulty==='beginner'?3:6;
  const selected=shuffle(imageList).slice(0,numItems);
  const missingIndex=Math.floor(Math.random()*selected.length);
  const missing=selected[missingIndex];
  const itemsInGrid=selected.filter((_,i)=>i!==missingIndex);
  qEl.textContent='Which picture is missing?';
  speak('Which picture is missing?');

  const qBox=document.createElement('div'); qBox.className='option-container';
  selected.forEach((s,i)=>{
    if(i===missingIndex){
      const blank=document.createElement('div');
      blank.className='blank'; qBox.appendChild(blank);
    } else {
      qBox.appendChild(createAnswerTile(s,false));
    }
  });
  optionsEl.appendChild(qBox);

  const wrong=shuffle(itemsInGrid).slice(0,2);
  const choices=shuffle([missing,...wrong]);
  const ans=document.createElement('div'); ans.className='answer-container';
  choices.forEach(c=> ans.appendChild(createAnswerTile(c,c===missing)));
  optionsEl.appendChild(ans);
}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Kids Learning Game</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body {
    margin: 0;
    font-family: "Comic Sans MS", Arial, sans-serif;
    background: linear-gradient(135deg, #a8c0ff, #3f2b96);
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    color: #fff;
  }

  #startScreen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  #startScreen h1 {
    font-size: 3.5rem;
    color: #ffeb3b;
    text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
    margin-bottom: 30px;
  }
  .start-button {
    font-size: 2.8rem;
    padding: 20px 50px;
    border-radius: 50px;
    border: none;
    background: linear-gradient(45deg, #ff9800, #ff5722);
    color: #fff;
    cursor: pointer;
    box-shadow: 0 8px 25px rgba(255,140,0,0.6);
    animation: glow 2s infinite alternate;
    transition: transform 0.2s;
  }
  .start-button:hover { transform: scale(1.05); }
  @keyframes glow {
    from { box-shadow: 0 0 20px #ff9800; }
    to { box-shadow: 0 0 40px #ff5722; }
  }

  .game-container {
    display: none;
    width: 100%;
    max-width: 800px;
    padding: 20px;
    box-sizing: border-box;
    text-align: center;
    background: rgba(255,255,255,0.1);
    border-radius: 20px;
    box-shadow: 0 0 30px rgba(0,0,0,0.3);
  }
  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    font-size: 1.8rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  }
  #question { font-size: 2rem; color:#fff; margin:10px auto; }
  .score { font-size:1.5rem; color:#ffeb3b; font-weight:700; text-shadow:1px 1px 3px rgba(0,0,0,0.4); }

  .option-container {
    border: 4px dashed #ffeb3b;
    border-radius: 20px;
    padding: 18px;
    margin: 25px 0;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 18px;
    background: rgba(255,255,255,0.12);
    justify-items: center;
    align-items: center;
  }

  .answer-container {
    border: 4px dashed #81c784;
    border-radius: 20px;
    padding: 18px;
    margin-top: 30px;
    display: flex;
    flex-wrap: wrap;
    gap: 18px;
    justify-content: center;
    background: rgba(255,255,255,0.08);
  }

  .option {
    width: 140px; height:140px;
    border-radius:25px; background:#fff;
    box-shadow:0 8px 18px rgba(0,0,0,0.25);
    cursor:pointer; position:relative; overflow:hidden;
    perspective: 600px;
  }
  .option-inner { width:100%; height:100%; position:relative; transform-style: preserve-3d; transition: transform 0.6s; }
  .option.flipped .option-inner { transform: rotateY(180deg); }
  .option-front, .option-back { position:absolute; width:100%; height:100%; backface-visibility: hidden; border-radius:25px; display:flex; align-items:center; justify-content:center; }
  .option-front img { width:95%; height:95%; object-fit:contain; }
  .option-back { background:#f0f0f0; transform: rotateY(180deg); font-size:2rem; color:#888; border:3px dashed #9e9e9e; }
  .option:hover { transform: scale(1.08); }

  .question-tile { cursor:default; pointer-events:none; }
  .blank { background:#f0f0f0; display:flex; align-items:center; justify-content:center; font-size:3rem; color:#666; border:3px dashed #9e9e9e; }

  .star-effect {
    position:absolute; pointer-events:none; font-size:1.8rem; color:gold;
    animation: starFloat 1s ease-out forwards;
  }
  @keyframes starFloat {
    0% { opacity:1; transform: translateY(0) scale(1); }
    50% { opacity:1; transform: translateY(-50px) scale(1.5); }
    100% { opacity:0; transform: translateY(-120px) scale(0.8); }
  }

  .congrats {
    position: fixed; left:50%; top:50%; transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #ffeb3b, #ff9800);
    padding:40px 50px; border-radius:25px;
    font-size:2.2rem; color:#fff; text-align:center;
    box-shadow:0 0 60px rgba(255,140,0,0.9); z-index:2000; display:none; overflow:visible;
  }

  #exitBtn { margin-top:20px; padding:12px 25px; border-radius:18px; border:none; background:#e53935; color:#fff; font-size:1.1rem; cursor:pointer; }
  #exitBtn:hover { background:#c62828; }

  @media(max-width:600px){
    .option-container{ grid-template-columns: repeat(2, 1fr); gap:12px; }
    .option{ width:110px; height:110px; }
    .start-button{ font-size:2rem; padding:16px 36px; }
  }
</style>
</head>
<body>

<div id="startScreen">
  <h1>ðŸŒŸ Fun Learning Game ðŸŒŸ</h1>
  <button id="startBtn" class="start-button">â–¶ Start Game</button>
</div>

<div id="game" class="game-container" aria-live="polite">
  <div class="top-bar">
    <div id="question"></div>
    <div id="score" class="score">Score: 0</div>
  </div>
  <div id="options"></div>
  <button id="exitBtn">Exit Game</button>
</div>

<div id="congrats" class="congrats"></div>

<audio id="bgMusic" src="https://actions.google.com/sounds/v1/musical/melodious_tunes.ogg" loop></audio>
<audio id="correctSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="wrongSound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="congratsMusic" src="https://actions.google.com/sounds/v1/cartoon/party_horn.ogg"></audio>

<script>
const imageList=["apple","ball","banana","car","cat","cherry","dog","fish","flower","orange"];
let currentMode="find", voicesReady=false, score=0, waitingNextRound=false, roundAnswered=false;
const loadedImages={}, bgMusic=document.getElementById('bgMusic'), correctSound=document.getElementById('correctSound'),
wrongSound=document.getElementById('wrongSound'), congratsMusic=document.getElementById('congratsMusic'),
scoreEl=document.getElementById('score'), congratsEl=document.getElementById('congrats'),
startBtn=document.getElementById('startBtn'), startScreen=document.getElementById('startScreen'),
game=document.getElementById('game'), qEl=document.getElementById('question'), optionsEl=document.getElementById('options'),
exitBtn=document.getElementById('exitBtn');

imageList.forEach(name=>{ const img=new Image(); img.src=`image/${name}.png`; loadedImages[name]=img; });

startBtn.addEventListener('click', ()=>{
  voicesReady=true; try{bgMusic.play();}catch(e){}
  startScreen.style.display='none'; game.style.display='block'; score=0; updateScore(); nextRound();
});
exitBtn.addEventListener('click', ()=>{ try{bgMusic.pause(); bgMusic.currentTime=0;}catch(e){} window.location.href='index.html'; });

function speak(text,cb=null){ if(!voicesReady){ if(cb)setTimeout(cb,400); return;} const u=new SpeechSynthesisUtterance(text); u.rate=0.8; u.pitch=1.15; if(cb) u.onend=cb; speechSynthesis.speak(u); }
function updateScore(){ scoreEl.textContent=`Score: ${score}`; if(score>0 && score%10===0 && !waitingNextRound) showCongratsPopup(score); }

function showCongratsPopup(scoreVal){
  waitingNextRound=true; congratsEl.innerHTML=`ðŸŽ‰ Congratulations! ðŸŽ‰<br>You got ${scoreVal} points!`;
  congratsEl.style.display='block';
  try{ congratsMusic.currentTime=0; congratsMusic.play(); }catch(e){}
  for(let i=0;i<18;i++){ const s=document.createElement('div'); s.className='star-effect';
    s.style.left=(20+Math.random()*(window.innerWidth-40))+'px';
    s.style.top=(window.innerHeight+20)+'px';
    congratsEl.appendChild(s); setTimeout(()=>s.remove(),2200);
  }
  speak(`Congratulations, you have got ${scoreVal} points!`, ()=>{
    congratsEl.style.display='none'; waitingNextRound=false; try{congratsMusic.pause(); congratsMusic.currentTime=0;}catch(e){}; nextRound();
  });
}

function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5); }
function nextRound(){
  if(waitingNextRound) return; roundAnswered=false; optionsEl.innerHTML='';
  const modes=['find','different','missing','memory','shadow'];
  currentMode=modes[Math.floor(Math.random()*modes.length)];
  if(currentMode==='find') startFindRound();
  else if(currentMode==='different') startDifferentRound();
  else if(currentMode==='missing') startMissingRound();
  else if(currentMode==='memory') startMemoryRound();
  else if(currentMode==='shadow') startShadowRound();
}

function createQuestionTile(name,parent){ const tile=document.createElement('div'); tile.className='option question-tile'; const img=document.createElement('img'); img.src=loadedImages[name].src; img.alt=name; tile.appendChild(img); parent.appendChild(tile); }
function createAnswerTile(name,isCorrect,parent,blankDiv=null,missing=null){
  const tile=document.createElement('div'); tile.className='option'; tile.dataset.correct=isCorrect?'1':'0';
  const img=document.createElement('img'); img.src=loadedImages[name].src; img.alt=name; tile.appendChild(img);
  tile.addEventListener('click',()=>{
    if(roundAnswered) return; const correct=tile.dataset.correct==='1';
    if(correct){ roundAnswered=true; try{ correctSound.currentTime=0; correctSound.play(); }catch(e){}; score++; updateScore();
      if(blankDiv && missing){ blankDiv.innerHTML=''; const im=document.createElement('img'); im.src=loadedImages[missing].src; im.alt=missing; blankDiv.appendChild(im); }
      speak('Well done!',()=>setTimeout(()=> nextRound(),500));
    }else{ try{ wrongSound.currentTime=0; wrongSound.play(); }catch(e){}; speak('Try again'); }
  });
  parent.appendChild(tile);
}

function startFindRound(){ const choices=shuffle(imageList).slice(0,4); const target=choices[Math.floor(Math.random()*choices.length)];
  qEl.textContent=`Find the ${target}`; speak(`Can you find the ${target}?`);
  const ansContainer=document.createElement('div'); ansContainer.className='answer-container'; shuffle(choices).forEach(name=>createAnswerTile(name,name===target,ansContainer)); optionsEl.appendChild(ansContainer);
}

function startDifferentRound(){ const base=imageList[Math.floor(Math.random()*imageList.length)]; let odd; do{ odd=imageList[Math.floor(Math.random()*imageList.length)]; }while(odd===base);
  qEl.textContent='Find the different one!'; speak('Which one is different?');
  const arr=shuffle([base,base,base,odd]); const ansContainer=document.createElement('div'); ansContainer.className='answer-container'; arr.forEach(name=>createAnswerTile(name,name===odd,ansContainer)); optionsEl.appendChild(ansContainer);
}

function startMissingRound(){
  const selected=shuffle(imageList).slice(0,6); const missingIndex=Math.floor(Math.random()*selected.length); const missing=selected[missingIndex]; const itemsInGrid=selected.filter((_,idx)=>idx!==missingIndex);
  qEl.textContent='Which picture is missing?'; speak('Which picture is missing?');
  const questionContainer=document.createElement('div'); questionContainer.className='option-container';
  let blankDiv=null; selected.forEach((name,idx)=>{ if(idx===missingIndex){ blankDiv=document.createElement('div'); blankDiv.className='option blank'; questionContainer.appendChild(blankDiv); } else { createQuestionTile(name,questionContainer); } });
  optionsEl.appendChild(questionContainer);
  const wrongOptions=shuffle(itemsInGrid).slice(0,2); const answerChoices=shuffle([missing,...wrongOptions]);
  const answerContainer=document.createElement('div'); answerContainer.className='answer-container';
  answerChoices.forEach(name=>createAnswerTile(name,name===missing,answerContainer,blankDiv,missing));
  optionsEl.appendChild(answerContainer);
}

function startMemoryRound(){
  qEl.textContent="Can you find the matching pair?"; speak("Can you find the matching pair?");
  const ansContainer=document.createElement('div'); ansContainer.className='option-container';
  const pairImage=imageList[Math.floor(Math.random()*imageList.length)];
  const others=shuffle(imageList.filter(n=>n!==pairImage)).slice(0,4); const cards=shuffle([pairImage,pairImage,...others]);
  let flippedCard=null;
  cards.forEach(name=>{
    const tile=document.createElement('div'); tile.className='option'; tile.dataset.name=name;
    const inner=document.createElement('div'); inner.className='option-inner';
    const front=document.createElement('div'); front.className='option-front'; const img=document.createElement('img'); img.src=loadedImages[name].src; img.alt=name; front.appendChild(img);
    const back=document.createElement('div'); back.className='option-back'; back.textContent="?";
    inner.appendChild(front); inner.appendChild(back); tile.appendChild(inner);
    tile.addEventListener('click',()=>{
      if(tile.classList.contains('matched')) return; if(tile===flippedCard) return;
      tile.classList.add('flipped');
      if(!flippedCard){ flippedCard=tile; }
      else{
        if(tile.dataset.name===flippedCard.dataset.name){
          tile.classList.add('matched'); flippedCard.classList.add('matched');
          try{ correctSound.currentTime=0; correctSound.play(); }catch(e){}
          score++; updateScore();
          createFireworks(tile);
          flippedCard=null;
          speak("Well done!", ()=>setTimeout(nextRound,800));
        } else { const prev=flippedCard; flippedCard=tile; setTimeout(()=>prev.classList.remove('flipped'),500); }
      }
    });
    ansContainer.appendChild(tile);
  });
  optionsEl.appendChild(ansContainer);
}

function createFireworks(tile){
  const rect=tile.getBoundingClientRect(); for(let i=0;i<12;i++){
    const star=document.createElement('div'); star.className='star-effect';
    star.style.left=(rect.left+Math.random()*rect.width)+'px';
    star.style.top=(rect.top+Math.random()*rect.height)+'px';
    document.body.appendChild(star); setTimeout(()=>star.remove(),1200);
  }
}

function startShadowRound(){
  qEl.textContent='Find the shadow!'; speak('Can you find the shadow!');
  const ansContainer=document.createElement('div'); ansContainer.className='answer-container';
  const selected=shuffle(imageList).slice(0,4); const target=selected[Math.floor(Math.random()*selected.length)];
  const shadowCanvas=document.createElement('canvas'); shadowCanvas.width=140; shadowCanvas.height=140; const ctx=shadowCanvas.getContext('2d');
  const img=loadedImages[target]; img.onload=()=>{
    ctx.drawImage(img,0,0,140,140);
    const imageData=ctx.getImageData(0,0,140,140); for(let i=0;i<imageData.data.length;i+=4){ imageData.data[i]=0; imageData.data[i+1]=0; imageData.data[i+2]=0; } ctx.putImageData(imageData,0,0);
  }
  selected.forEach(name=>{
    const isCorrect=name===target;
    const tile=document.createElement('div'); tile.className='option'; const imgEl=document.createElement('img');
    if(isCorrect){ imgEl.src=shadowCanvas.toDataURL(); } else { imgEl.src=loadedImages[name].src; }
    tile.appendChild(imgEl); tile.dataset.correct=isCorrect?'1':'0';
    tile.addEventListener('click',()=>{
      if(roundAnswered) return; if(tile.dataset.correct==='1'){
        roundAnswered=true; score++; updateScore(); try{ correctSound.currentTime=0; correctSound.play(); }catch(e){} speak('Well done!',()=>setTimeout(nextRound,500));
      } else { try{ wrongSound.currentTime=0; wrongSound.play(); }catch(e){} speak('Try again'); }
    });
    ansContainer.appendChild(tile);
  });
  optionsEl.appendChild(ansContainer);
}
</script>
</body>
</html>
